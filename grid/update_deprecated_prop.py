#!/usr/bin/env python

import sys, fileinput

# Apache Hadoop 2.7.2
# Deprecated Properties
# https://hadoop.apache.org/docs/r2.7.2/hadoop-project-dist/hadoop-common/DeprecatedProperties.html
hdp_depr_prop_hash = {}
hdp_depr_prop_hash['create.empty.dir.if.nonexist'] = "mapreduce.jobcontrol.createdir.ifnotexist"
hdp_depr_prop_hash['dfs.access.time.precision'] = "dfs.namenode.accesstime.precision"
hdp_depr_prop_hash['dfs.backup.address'] = "dfs.namenode.backup.address"
hdp_depr_prop_hash['dfs.backup.http.address'] = "dfs.namenode.backup.http-address"
hdp_depr_prop_hash['dfs.balance.bandwidthPerSec'] = "dfs.datanode.balance.bandwidthPerSec"
hdp_depr_prop_hash['dfs.block.size'] = "dfs.blocksize"
hdp_depr_prop_hash['dfs.data.dir'] = "dfs.datanode.data.dir"
hdp_depr_prop_hash['dfs.datanode.max.xcievers'] = "dfs.datanode.max.transfer.threads"
hdp_depr_prop_hash['dfs.df.interval'] = "fs.df.interval"
hdp_depr_prop_hash['dfs.federation.nameservice.id'] = "dfs.nameservice.id"
hdp_depr_prop_hash['dfs.federation.nameservices'] = "dfs.nameservices"
hdp_depr_prop_hash['dfs.http.address'] = "dfs.namenode.http-address"
hdp_depr_prop_hash['dfs.https.address'] = "dfs.namenode.https-address"
hdp_depr_prop_hash['dfs.https.client.keystore.resource'] = "dfs.client.https.keystore.resource"
hdp_depr_prop_hash['dfs.https.need.client.auth'] = "dfs.client.https.need-auth"
hdp_depr_prop_hash['dfs.max.objects'] = "dfs.namenode.max.objects"
hdp_depr_prop_hash['dfs.max-repl-streams'] = "dfs.namenode.replication.max-streams"
hdp_depr_prop_hash['dfs.name.dir'] = "dfs.namenode.name.dir"
hdp_depr_prop_hash['dfs.name.dir.restore'] = "dfs.namenode.name.dir.restore"
hdp_depr_prop_hash['dfs.name.edits.dir'] = "dfs.namenode.edits.dir"
hdp_depr_prop_hash['dfs.permissions'] = "dfs.permissions.enabled"
hdp_depr_prop_hash['dfs.permissions.supergroup'] = "dfs.permissions.superusergroup"
hdp_depr_prop_hash['dfs.read.prefetch.size'] = "dfs.client.read.prefetch.size"
hdp_depr_prop_hash['dfs.replication.considerLoad'] = "dfs.namenode.replication.considerLoad"
hdp_depr_prop_hash['dfs.replication.interval'] = "dfs.namenode.replication.interval"
hdp_depr_prop_hash['dfs.replication.min'] = "dfs.namenode.replication.min"
hdp_depr_prop_hash['dfs.replication.pending.timeout.sec'] = "dfs.namenode.replication.pending.timeout-sec"
hdp_depr_prop_hash['dfs.safemode.extension'] = "dfs.namenode.safemode.extension"
hdp_depr_prop_hash['dfs.safemode.threshold.pct'] = "dfs.namenode.safemode.threshold-pct"
hdp_depr_prop_hash['dfs.secondary.http.address'] = "dfs.namenode.secondary.http-address"
hdp_depr_prop_hash['dfs.socket.timeout'] = "dfs.client.socket-timeout"
hdp_depr_prop_hash['dfs.umaskmode'] = "fs.permissions.umask-mode"
hdp_depr_prop_hash['dfs.write.packet.size'] = "dfs.client-write-packet-size"
hdp_depr_prop_hash['fs.checkpoint.dir'] = "dfs.namenode.checkpoint.dir"
hdp_depr_prop_hash['fs.checkpoint.edits.dir'] = "dfs.namenode.checkpoint.edits.dir"
hdp_depr_prop_hash['fs.checkpoint.period'] = "dfs.namenode.checkpoint.period"
hdp_depr_prop_hash['fs.default.name'] = "fs.defaultFS"
hdp_depr_prop_hash['hadoop.configured.node.mapping'] = "net.topology.configured.node.mapping"
hdp_depr_prop_hash['hadoop.job.history.location'] = "mapreduce.jobtracker.jobhistory.location"
hdp_depr_prop_hash['hadoop.native.lib'] = "io.native.lib.available"
hdp_depr_prop_hash['hadoop.net.static.resolutions'] = "mapreduce.tasktracker.net.static.resolutions"
hdp_depr_prop_hash['hadoop.pipes.command-file.keep'] = "mapreduce.pipes.commandfile.preserve"
hdp_depr_prop_hash['hadoop.pipes.executable.interpretor'] = "mapreduce.pipes.executable.interpretor"
hdp_depr_prop_hash['hadoop.pipes.executable'] = "mapreduce.pipes.executable"
hdp_depr_prop_hash['hadoop.pipes.java.mapper'] = "mapreduce.pipes.isjavamapper"
hdp_depr_prop_hash['hadoop.pipes.java.recordreader'] = "mapreduce.pipes.isjavarecordreader"
hdp_depr_prop_hash['hadoop.pipes.java.recordwriter'] = "mapreduce.pipes.isjavarecordwriter"
hdp_depr_prop_hash['hadoop.pipes.java.reducer'] = "mapreduce.pipes.isjavareducer"
hdp_depr_prop_hash['hadoop.pipes.partitioner'] = "mapreduce.pipes.partitioner"
hdp_depr_prop_hash['heartbeat.recheck.interval'] = "dfs.namenode.heartbeat.recheck-interval"
hdp_depr_prop_hash['io.bytes.per.checksum'] = "dfs.bytes-per-checksum"
hdp_depr_prop_hash['io.sort.factor'] = "mapreduce.task.io.sort.factor"
hdp_depr_prop_hash['io.sort.mb'] = "mapreduce.task.io.sort.mb"
hdp_depr_prop_hash['io.sort.spill.percent'] = "mapreduce.map.sort.spill.percent"
hdp_depr_prop_hash['jobclient.completion.poll.interval'] = "mapreduce.client.completion.pollinterval"
hdp_depr_prop_hash['jobclient.output.filter'] = "mapreduce.client.output.filter"
hdp_depr_prop_hash['jobclient.progress.monitor.poll.interval'] = "mapreduce.client.progressmonitor.pollinterval"
hdp_depr_prop_hash['job.end.notification.url'] = "mapreduce.job.end-notification.url"
hdp_depr_prop_hash['job.end.retry.attempts'] = "mapreduce.job.end-notification.retry.attempts"
hdp_depr_prop_hash['job.end.retry.interval'] = "mapreduce.job.end-notification.retry.interval"
hdp_depr_prop_hash['job.local.dir'] = "mapreduce.job.local.dir"
hdp_depr_prop_hash['keep.failed.task.files'] = "mapreduce.task.files.preserve.failedtasks"
hdp_depr_prop_hash['keep.task.files.pattern'] = "mapreduce.task.files.preserve.filepattern"
hdp_depr_prop_hash['key.value.separator.in.input.line'] = "mapreduce.input.keyvaluelinerecordreader.key.value.separator"
hdp_depr_prop_hash['local.cache.size'] = "mapreduce.tasktracker.cache.local.size"
hdp_depr_prop_hash['map.input.file'] = "mapreduce.map.input.file"
hdp_depr_prop_hash['map.input.length'] = "mapreduce.map.input.length"
hdp_depr_prop_hash['map.input.start'] = "mapreduce.map.input.start"
hdp_depr_prop_hash['map.output.key.field.separator'] = "mapreduce.map.output.key.field.separator"
hdp_depr_prop_hash['map.output.key.value.fields.spec'] = "mapreduce.fieldsel.map.output.key.value.fields.spec"
hdp_depr_prop_hash['mapred.acls.enabled'] = "mapreduce.cluster.acls.enabled"
hdp_depr_prop_hash['mapred.binary.partitioner.left.offset'] = "mapreduce.partition.binarypartitioner.left.offset"
hdp_depr_prop_hash['mapred.binary.partitioner.right.offset'] = "mapreduce.partition.binarypartitioner.right.offset"
hdp_depr_prop_hash['mapred.cache.archives'] = "mapreduce.job.cache.archives"
hdp_depr_prop_hash['mapred.cache.archives.timestamps'] = "mapreduce.job.cache.archives.timestamps"
hdp_depr_prop_hash['mapred.cache.files'] = "mapreduce.job.cache.files"
hdp_depr_prop_hash['mapred.cache.files.timestamps'] = "mapreduce.job.cache.files.timestamps"
hdp_depr_prop_hash['mapred.cache.localArchives'] = "mapreduce.job.cache.local.archives"
hdp_depr_prop_hash['mapred.cache.localFiles'] = "mapreduce.job.cache.local.files"
hdp_depr_prop_hash['mapred.child.tmp'] = "mapreduce.task.tmp.dir"
hdp_depr_prop_hash['mapred.cluster.average.blacklist.threshold'] = "mapreduce.jobtracker.blacklist.average.threshold"
hdp_depr_prop_hash['mapred.cluster.map.memory.mb'] = "mapreduce.cluster.mapmemory.mb"
hdp_depr_prop_hash['mapred.cluster.max.map.memory.mb'] = "mapreduce.jobtracker.maxmapmemory.mb"
hdp_depr_prop_hash['mapred.cluster.max.reduce.memory.mb'] = "mapreduce.jobtracker.maxreducememory.mb"
hdp_depr_prop_hash['mapred.cluster.reduce.memory.mb'] = "mapreduce.cluster.reducememory.mb"
hdp_depr_prop_hash['mapred.committer.job.setup.cleanup.needed'] = "mapreduce.job.committer.setup.cleanup.needed"
hdp_depr_prop_hash['mapred.compress.map.output'] = "mapreduce.map.output.compress"
hdp_depr_prop_hash['mapred.data.field.separator'] = "mapreduce.fieldsel.data.field.separator"
hdp_depr_prop_hash['mapred.debug.out.lines'] = "mapreduce.task.debugout.lines"
hdp_depr_prop_hash['mapred.healthChecker.interval'] = "mapreduce.tasktracker.healthchecker.interval"
hdp_depr_prop_hash['mapred.healthChecker.script.args'] = "mapreduce.tasktracker.healthchecker.script.args"
hdp_depr_prop_hash['mapred.healthChecker.script.path'] = "mapreduce.tasktracker.healthchecker.script.path"
hdp_depr_prop_hash['mapred.healthChecker.script.timeout'] = "mapreduce.tasktracker.healthchecker.script.timeout"
hdp_depr_prop_hash['mapred.heartbeats.in.second'] = "mapreduce.jobtracker.heartbeats.in.second"
hdp_depr_prop_hash['mapred.hosts.exclude'] = "mapreduce.jobtracker.hosts.exclude.filename"
hdp_depr_prop_hash['mapred.hosts'] = "mapreduce.jobtracker.hosts.filename"
hdp_depr_prop_hash['mapred.inmem.merge.threshold'] = "mapreduce.reduce.merge.inmem.threshold"
hdp_depr_prop_hash['mapred.input.dir.formats'] = "mapreduce.input.multipleinputs.dir.formats"
hdp_depr_prop_hash['mapred.input.dir.mappers'] = "mapreduce.input.multipleinputs.dir.mappers"
hdp_depr_prop_hash['mapred.input.dir'] = "mapreduce.input.fileinputformat.inputdir"
hdp_depr_prop_hash['mapred.input.pathFilter.class'] = "mapreduce.input.pathFilter.class"
hdp_depr_prop_hash['mapred.jar'] = "mapreduce.job.jar"
hdp_depr_prop_hash['mapred.job.classpath.archives'] = "mapreduce.job.classpath.archives"
hdp_depr_prop_hash['mapred.job.classpath.files'] = "mapreduce.job.classpath.files"
hdp_depr_prop_hash['mapred.job.id'] = "mapreduce.job.id"
hdp_depr_prop_hash['mapred.jobinit.threads'] = "mapreduce.jobtracker.jobinit.threads"
hdp_depr_prop_hash['mapred.job.map.memory.mb'] = "mapreduce.map.memory.mb"
hdp_depr_prop_hash['mapred.job.name'] = "mapreduce.job.name"
hdp_depr_prop_hash['mapred.job.priority'] = "mapreduce.job.priority"
hdp_depr_prop_hash['mapred.job.queue.name'] = "mapreduce.job.queuename"
hdp_depr_prop_hash['mapred.job.reduce.input.buffer.percent'] = "mapreduce.reduce.input.buffer.percent"
hdp_depr_prop_hash['mapred.job.reduce.markreset.buffer.percent'] = "mapreduce.reduce.markreset.buffer.percent"
hdp_depr_prop_hash['mapred.job.reduce.memory.mb'] = "mapreduce.reduce.memory.mb"
hdp_depr_prop_hash['mapred.job.reduce.total.mem.bytes'] = "mapreduce.reduce.memory.totalbytes"
hdp_depr_prop_hash['mapred.job.reuse.jvm.num.tasks'] = "mapreduce.job.jvm.numtasks"
hdp_depr_prop_hash['mapred.job.shuffle.input.buffer.percent'] = "mapreduce.reduce.shuffle.input.buffer.percent"
hdp_depr_prop_hash['mapred.job.shuffle.merge.percent'] = "mapreduce.reduce.shuffle.merge.percent"
hdp_depr_prop_hash['mapred.job.tracker.handler.count'] = "mapreduce.jobtracker.handler.count"
hdp_depr_prop_hash['mapred.job.tracker.history.completed.location'] = "mapreduce.jobtracker.jobhistory.completed.location"
hdp_depr_prop_hash['mapred.job.tracker.http.address'] = "mapreduce.jobtracker.http.address"
hdp_depr_prop_hash['mapred.jobtracker.instrumentation'] = "mapreduce.jobtracker.instrumentation"
hdp_depr_prop_hash['mapred.jobtracker.job.history.block.size'] = "mapreduce.jobtracker.jobhistory.block.size"
hdp_depr_prop_hash['mapred.job.tracker.jobhistory.lru.cache.size'] = "mapreduce.jobtracker.jobhistory.lru.cache.size"
hdp_depr_prop_hash['mapred.job.tracker'] = "mapreduce.jobtracker.address"
hdp_depr_prop_hash['mapred.jobtracker.maxtasks.per.job'] = "mapreduce.jobtracker.maxtasks.perjob"
hdp_depr_prop_hash['mapred.job.tracker.persist.jobstatus.active'] = "mapreduce.jobtracker.persist.jobstatus.active"
hdp_depr_prop_hash['mapred.job.tracker.persist.jobstatus.dir'] = "mapreduce.jobtracker.persist.jobstatus.dir"
hdp_depr_prop_hash['mapred.job.tracker.persist.jobstatus.hours'] = "mapreduce.jobtracker.persist.jobstatus.hours"
hdp_depr_prop_hash['mapred.jobtracker.restart.recover'] = "mapreduce.jobtracker.restart.recover"
hdp_depr_prop_hash['mapred.job.tracker.retiredjobs.cache.size'] = "mapreduce.jobtracker.retiredjobs.cache.size"
hdp_depr_prop_hash['mapred.job.tracker.retire.jobs'] = "mapreduce.jobtracker.retirejobs"
hdp_depr_prop_hash['mapred.jobtracker.taskalloc.capacitypad'] = "mapreduce.jobtracker.taskscheduler.taskalloc.capacitypad"
hdp_depr_prop_hash['mapred.jobtracker.taskScheduler'] = "mapreduce.jobtracker.taskscheduler"
hdp_depr_prop_hash['mapred.jobtracker.taskScheduler.maxRunningTasksPerJob'] = "mapreduce.jobtracker.taskscheduler.maxrunningtasks.perjob"
hdp_depr_prop_hash['mapred.join.expr'] = "mapreduce.join.expr"
hdp_depr_prop_hash['mapred.join.keycomparator'] = "mapreduce.join.keycomparator"
hdp_depr_prop_hash['mapred.lazy.output.format'] = "mapreduce.output.lazyoutputformat.outputformat"
hdp_depr_prop_hash['mapred.line.input.format.linespermap'] = "mapreduce.input.lineinputformat.linespermap"
hdp_depr_prop_hash['mapred.linerecordreader.maxlength'] = "mapreduce.input.linerecordreader.line.maxlength"
hdp_depr_prop_hash['mapred.local.dir'] = "mapreduce.cluster.local.dir"
hdp_depr_prop_hash['mapred.local.dir.minspacekill'] = "mapreduce.tasktracker.local.dir.minspacekill"
hdp_depr_prop_hash['mapred.local.dir.minspacestart'] = "mapreduce.tasktracker.local.dir.minspacestart"
hdp_depr_prop_hash['mapred.map.child.env'] = "mapreduce.map.env"
hdp_depr_prop_hash['mapred.map.child.java.opts'] = "mapreduce.map.java.opts"
hdp_depr_prop_hash['mapred.map.child.log.level'] = "mapreduce.map.log.level"
hdp_depr_prop_hash['mapred.map.max.attempts'] = "mapreduce.map.maxattempts"
hdp_depr_prop_hash['mapred.map.output.compression.codec'] = "mapreduce.map.output.compress.codec"
hdp_depr_prop_hash['mapred.mapoutput.key.class'] = "mapreduce.map.output.key.class"
hdp_depr_prop_hash['mapred.mapoutput.value.class'] = "mapreduce.map.output.value.class"
hdp_depr_prop_hash['mapred.mapper.regex.group'] = "mapreduce.mapper.regexmapper..group"
hdp_depr_prop_hash['mapred.mapper.regex'] = "mapreduce.mapper.regex"
hdp_depr_prop_hash['mapred.map.task.debug.script'] = "mapreduce.map.debug.script"
hdp_depr_prop_hash['mapred.map.tasks'] = "mapreduce.job.maps"
hdp_depr_prop_hash['mapred.map.tasks.speculative.execution'] = "mapreduce.map.speculative"
hdp_depr_prop_hash['mapred.max.map.failures.percent'] = "mapreduce.map.failures.maxpercent"
hdp_depr_prop_hash['mapred.max.reduce.failures.percent'] = "mapreduce.reduce.failures.maxpercent"
hdp_depr_prop_hash['mapred.max.split.size'] = "mapreduce.input.fileinputformat.split.maxsize"
hdp_depr_prop_hash['mapred.max.tracker.blacklists'] = "mapreduce.jobtracker.tasktracker.maxblacklists"
hdp_depr_prop_hash['mapred.max.tracker.failures'] = "mapreduce.job.maxtaskfailures.per.tracker"
hdp_depr_prop_hash['mapred.merge.recordsBeforeProgress'] = "mapreduce.task.merge.progress.records"
hdp_depr_prop_hash['mapred.min.split.size'] = "mapreduce.input.fileinputformat.split.minsize"
hdp_depr_prop_hash['mapred.min.split.size.per.node'] = "mapreduce.input.fileinputformat.split.minsize.per.node"
hdp_depr_prop_hash['mapred.min.split.size.per.rack'] = "mapreduce.input.fileinputformat.split.minsize.per.rack"
hdp_depr_prop_hash['mapred.output.compression.codec'] = "mapreduce.output.fileoutputformat.compress.codec"
hdp_depr_prop_hash['mapred.output.compression.type'] = "mapreduce.output.fileoutputformat.compress.type"
hdp_depr_prop_hash['mapred.output.compress'] = "mapreduce.output.fileoutputformat.compress"
hdp_depr_prop_hash['mapred.output.dir'] = "mapreduce.output.fileoutputformat.outputdir"
hdp_depr_prop_hash['mapred.output.key.class'] = "mapreduce.job.output.key.class"
hdp_depr_prop_hash['mapred.output.key.comparator.class'] = "mapreduce.job.output.key.comparator.class"
hdp_depr_prop_hash['mapred.output.value.class'] = "mapreduce.job.output.value.class"
hdp_depr_prop_hash['mapred.output.value.groupfn.class'] = "mapreduce.job.output.group.comparator.class"
hdp_depr_prop_hash['mapred.permissions.supergroup'] = "mapreduce.cluster.permissions.supergroup"
hdp_depr_prop_hash['mapred.pipes.user.inputformat'] = "mapreduce.pipes.inputformat"
hdp_depr_prop_hash['mapred.reduce.child.env'] = "mapreduce.reduce.env"
hdp_depr_prop_hash['mapred.reduce.child.java.opts'] = "mapreduce.reduce.java.opts"
hdp_depr_prop_hash['mapred.reduce.child.log.level'] = "mapreduce.reduce.log.level"
hdp_depr_prop_hash['mapred.reduce.max.attempts'] = "mapreduce.reduce.maxattempts"
hdp_depr_prop_hash['mapred.reduce.parallel.copies'] = "mapreduce.reduce.shuffle.parallelcopies"
hdp_depr_prop_hash['mapred.reduce.slowstart.completed.maps'] = "mapreduce.job.reduce.slowstart.completedmaps"
hdp_depr_prop_hash['mapred.reduce.task.debug.script'] = "mapreduce.reduce.debug.script"
hdp_depr_prop_hash['mapred.reduce.tasks'] = "mapreduce.job.reduces"
hdp_depr_prop_hash['mapred.reduce.tasks.speculative.execution'] = "mapreduce.reduce.speculative"
hdp_depr_prop_hash['mapred.seqbinary.output.key.class'] = "mapreduce.output.seqbinaryoutputformat.key.class"
hdp_depr_prop_hash['mapred.seqbinary.output.value.class'] = "mapreduce.output.seqbinaryoutputformat.value.class"
hdp_depr_prop_hash['mapred.shuffle.connect.timeout'] = "mapreduce.reduce.shuffle.connect.timeout"
hdp_depr_prop_hash['mapred.shuffle.read.timeout'] = "mapreduce.reduce.shuffle.read.timeout"
hdp_depr_prop_hash['mapred.skip.attempts.to.start.skipping'] = "mapreduce.task.skip.start.attempts"
hdp_depr_prop_hash['mapred.skip.map.auto.incr.proc.count'] = "mapreduce.map.skip.proc-count.auto-incr"
hdp_depr_prop_hash['mapred.skip.map.max.skip.records'] = "mapreduce.map.skip.maxrecords"
hdp_depr_prop_hash['mapred.skip.on'] = "mapreduce.job.skiprecords"
hdp_depr_prop_hash['mapred.skip.out.dir'] = "mapreduce.job.skip.outdir"
hdp_depr_prop_hash['mapred.skip.reduce.auto.incr.proc.count'] = "mapreduce.reduce.skip.proc-count.auto-incr"
hdp_depr_prop_hash['mapred.skip.reduce.max.skip.groups'] = "mapreduce.reduce.skip.maxgroups"
hdp_depr_prop_hash['mapred.speculative.execution.slowNodeThreshold'] = "mapreduce.job.speculative.slownodethreshold"
hdp_depr_prop_hash['mapred.speculative.execution.slowTaskThreshold'] = "mapreduce.job.speculative.slowtaskthreshold"
hdp_depr_prop_hash['mapred.speculative.execution.speculativeCap'] = "mapreduce.job.speculative.speculativecap"
hdp_depr_prop_hash['mapred.submit.replication'] = "mapreduce.client.submit.file.replication"
hdp_depr_prop_hash['mapred.system.dir'] = "mapreduce.jobtracker.system.dir"
hdp_depr_prop_hash['mapred.task.cache.levels'] = "mapreduce.jobtracker.taskcache.levels"
hdp_depr_prop_hash['mapred.task.id'] = "mapreduce.task.attempt.id"
hdp_depr_prop_hash['mapred.task.is.map'] = "mapreduce.task.ismap"
hdp_depr_prop_hash['mapred.task.partition'] = "mapreduce.task.partition"
hdp_depr_prop_hash['mapred.task.profile'] = "mapreduce.task.profile"
hdp_depr_prop_hash['mapred.task.profile.maps'] = "mapreduce.task.profile.maps"
hdp_depr_prop_hash['mapred.task.profile.params'] = "mapreduce.task.profile.params"
hdp_depr_prop_hash['mapred.task.profile.reduces'] = "mapreduce.task.profile.reduces"
hdp_depr_prop_hash['mapred.task.timeout'] = "mapreduce.task.timeout"
hdp_depr_prop_hash['mapred.tasktracker.dns.interface'] = "mapreduce.tasktracker.dns.interface"
hdp_depr_prop_hash['mapred.tasktracker.dns.nameserver'] = "mapreduce.tasktracker.dns.nameserver"
hdp_depr_prop_hash['mapred.tasktracker.events.batchsize'] = "mapreduce.tasktracker.events.batchsize"
hdp_depr_prop_hash['mapred.tasktracker.expiry.interval'] = "mapreduce.jobtracker.expire.trackers.interval"
hdp_depr_prop_hash['mapred.task.tracker.http.address'] = "mapreduce.tasktracker.http.address"
hdp_depr_prop_hash['mapred.tasktracker.indexcache.mb'] = "mapreduce.tasktracker.indexcache.mb"
hdp_depr_prop_hash['mapred.tasktracker.instrumentation'] = "mapreduce.tasktracker.instrumentation"
hdp_depr_prop_hash['mapred.tasktracker.map.tasks.maximum'] = "mapreduce.tasktracker.map.tasks.maximum"
hdp_depr_prop_hash['mapred.tasktracker.memory_calculator_plugin'] = "mapreduce.tasktracker.resourcecalculatorplugin"
hdp_depr_prop_hash['mapred.tasktracker.memorycalculatorplugin'] = "mapreduce.tasktracker.resourcecalculatorplugin"
hdp_depr_prop_hash['mapred.tasktracker.reduce.tasks.maximum'] = "mapreduce.tasktracker.reduce.tasks.maximum"
hdp_depr_prop_hash['mapred.task.tracker.report.address'] = "mapreduce.tasktracker.report.address"
hdp_depr_prop_hash['mapred.task.tracker.task-controller'] = "mapreduce.tasktracker.taskcontroller"
hdp_depr_prop_hash['mapred.tasktracker.taskmemorymanager.monitoring-interval'] = "mapreduce.tasktracker.taskmemorymanager.monitoringinterval"
hdp_depr_prop_hash['mapred.tasktracker.tasks.sleeptime-before-sigkill'] = "mapreduce.tasktracker.tasks.sleeptimebeforesigkill"
hdp_depr_prop_hash['mapred.temp.dir'] = "mapreduce.cluster.temp.dir"
hdp_depr_prop_hash['mapred.text.key.comparator.options'] = "mapreduce.partition.keycomparator.options"
hdp_depr_prop_hash['mapred.text.key.partitioner.options'] = "mapreduce.partition.keypartitioner.options"
hdp_depr_prop_hash['mapred.textoutputformat.separator'] = "mapreduce.output.textoutputformat.separator"
hdp_depr_prop_hash['mapred.tip.id'] = "mapreduce.task.id"
hdp_depr_prop_hash['mapreduce.combine.class'] = "mapreduce.job.combine.class"
hdp_depr_prop_hash['mapreduce.inputformat.class'] = "mapreduce.job.inputformat.class"
hdp_depr_prop_hash['mapreduce.job.counters.limit'] = "mapreduce.job.counters.max"
hdp_depr_prop_hash['mapreduce.jobtracker.permissions.supergroup'] = "mapreduce.cluster.permissions.supergroup"
hdp_depr_prop_hash['mapreduce.map.class'] = "mapreduce.job.map.class"
hdp_depr_prop_hash['mapreduce.outputformat.class'] = "mapreduce.job.outputformat.class"
hdp_depr_prop_hash['mapreduce.partitioner.class'] = "mapreduce.job.partitioner.class"
hdp_depr_prop_hash['mapreduce.reduce.class'] = "mapreduce.job.reduce.class"
hdp_depr_prop_hash['mapred.used.genericoptionsparser'] = "mapreduce.client.genericoptionsparser.used"
hdp_depr_prop_hash['mapred.userlog.limit.kb'] = "mapreduce.task.userlog.limit.kb"
hdp_depr_prop_hash['mapred.userlog.retain.hours'] = "mapreduce.job.userlog.retain.hours"
hdp_depr_prop_hash['mapred.working.dir'] = "mapreduce.job.working.dir"
hdp_depr_prop_hash['mapred.work.output.dir'] = "mapreduce.task.output.dir"
hdp_depr_prop_hash['min.num.spills.for.combine'] = "mapreduce.map.combine.minspills"
hdp_depr_prop_hash['reduce.output.key.value.fields.spec'] = "mapreduce.fieldsel.reduce.output.key.value.fields.spec"
hdp_depr_prop_hash['security.job.submission.protocol.acl'] = "security.job.client.protocol.acl"
hdp_depr_prop_hash['security.task.umbilical.protocol.acl'] = "security.job.task.protocol.acl"
hdp_depr_prop_hash['sequencefile.filter.class'] = "mapreduce.input.sequencefileinputfilter.class"
hdp_depr_prop_hash['sequencefile.filter.frequency'] = "mapreduce.input.sequencefileinputfilter.frequency"
hdp_depr_prop_hash['sequencefile.filter.regex'] = "mapreduce.input.sequencefileinputfilter.regex"
hdp_depr_prop_hash['session.id'] = "dfs.metrics.session-id"
hdp_depr_prop_hash['slave.host.name'] = "dfs.datanode.hostname"
hdp_depr_prop_hash['slave.host.name'] = "mapreduce.tasktracker.host.name"
hdp_depr_prop_hash['tasktracker.contention.tracking'] = "mapreduce.tasktracker.contention.tracking"
hdp_depr_prop_hash['tasktracker.http.threads'] = "mapreduce.tasktracker.http.threads"
hdp_depr_prop_hash['topology.node.switch.mapping.impl'] = "net.topology.node.switch.mapping.impl"
hdp_depr_prop_hash['topology.script.file.name'] = "net.topology.script.file.name"
hdp_depr_prop_hash['topology.script.number.args'] = "net.topology.script.number.args"
hdp_depr_prop_hash['user.name'] = "mapreduce.job.user.name"
hdp_depr_prop_hash['webinterface.private.actions'] = "mapreduce.jobtracker.webinterface.trusted"
hdp_depr_prop_hash['yarn.app.mapreduce.yarn.app.mapreduce.client-am.ipc.max-retries-on-timeouts'] = "yarn.app.mapreduce.client-am.ipc.max-retries-on-timeouts"
hdp_depr_prop_hash['mapred.create.symlink'] = "NONE - symlinking is always on"
hdp_depr_prop_hash['mapreduce.job.cache.symlink.create'] = "NONE - symlinking is always on"

# Configure and Start Apache Tez
# Upgrade from HDP 2.1 to HDP 2.3 Manually
# https://docs.hortonworks.com/HDPDocuments/HDP2/HDP-2.3.0/bk_upgrading_hdp_manually/content/start-tez-21.html
tez_depr_prop_hash = {}
tez_depr_prop_hash['tez.am.java.opts'] = "tez.am.launch.cmd-opts"
tez_depr_prop_hash['tez.am.env'] = "tez.am.launch.env"
tez_depr_prop_hash['tez.am.shuffle-vertex-manager.min-src-fraction'] = "tez.shuffle-vertex-manager.min-src-fraction"
tez_depr_prop_hash['tez.am.shuffle-vertex-manager.max-src-fraction'] = "tez.shuffle-vertex-manager.max-src-fraction"
tez_depr_prop_hash['tez.am.shuffle-vertex-manager.enable.auto-parallel'] = "tez.shuffle-vertex-manager.enable.auto-parallel"
tez_depr_prop_hash['tez.am.shuffle-vertex-manager.desired-task-input-size'] = "tez.shuffle-vertex-manager.desired-task-input-size"
tez_depr_prop_hash['tez.am.shuffle-vertex-manager.min-task-parallelism'] = "tez.shuffle-vertex-manager.min-task-parallelism"
tez_depr_prop_hash['tez.am.grouping.split-count'] = "tez.grouping.split-count"
tez_depr_prop_hash['tez.am.grouping.by-length'] = "tez.grouping.by-length"
tez_depr_prop_hash['tez.am.grouping.by-count'] = "tez.grouping.by-count"
tez_depr_prop_hash['tez.am.grouping.max-size'] = "tez.grouping.max-size"
tez_depr_prop_hash['tez.am.grouping.min-size'] = "tez.grouping.min-size"
tez_depr_prop_hash['tez.am.grouping.rack-split-reduction'] = "tez.grouping.rack-split-reduction"
tez_depr_prop_hash['tez.am.am.complete.cancel.delegation.tokens'] = "tez.cancel.delegation.tokens.on.completion"
tez_depr_prop_hash['tez.am.max.task.attempts'] = "tez.am.task.max.failed.attempts"
tez_depr_prop_hash['tez.generate.dag.viz'] = "tez.generate.debug.artifacts"
tez_depr_prop_hash['tez.runtime.intermediate-output.key.comparator.class'] = "tez.runtime.key.comparator.class"
tez_depr_prop_hash['tez.runtime.intermediate-output.key.class'] = "tez.runtime.key.class"
tez_depr_prop_hash['tez.runtime.intermediate-output.value.class'] = "tez.runtime.value.class"
tez_depr_prop_hash['tez.runtime.intermediate-output.should-compress'] = "tez.runtime.compress"
tez_depr_prop_hash['tez.runtime.intermediate-output.compress.codec'] = "tez.runtime.compress.codec"
tez_depr_prop_hash['tez.runtime.intermediate-input.key.secondary.comparator.class'] = "tez.runtime.key.secondary.comparator.class"
tez_depr_prop_hash['tez.runtime.broadcast.data-via-events.enabled'] = "tez.runtime.transfer.data-via-events.enabled"
tez_depr_prop_hash['tez.runtime.broadcast.data-via-events.max-size'] = "tez.runtime.transfer.data-via-events.max-size"
tez_depr_prop_hash['tez.runtime.shuffle.input.buffer.percent'] = "tez.runtime.shuffle.fetch.buffer.percent"
tez_depr_prop_hash['tez.runtime.task.input.buffer.percent'] = "tez.runtime.task.input.post-merge.buffer.percent"
tez_depr_prop_hash['tez.runtime.job.counters.max'] = "tez.am.counters.max.keys"
tez_depr_prop_hash['tez.runtime.job.counters.group.name.max'] = "tez.am.counters.group-name.max.keys"
tez_depr_prop_hash['tez.runtime.job.counters.counter.name.max'] = "tez.am.counters.name.max.keys"
tez_depr_prop_hash['tez.runtime.job.counters.groups.max'] = "tez.am.counters.groups.max.keys"
tez_depr_prop_hash['tez.task.merge.progress.records'] = "tez.runtime.merge.progress.records"
tez_depr_prop_hash['tez.runtime.metrics.session.id'] = "tez.runtime.framework.metrics.session.id"
tez_depr_prop_hash['tez.task.scale.memory.additional.reservation. fraction.per-io'] = "tez.task.scale.memory.additional-reservation.fraction.per-io"
tez_depr_prop_hash['tez.task.scale.memory.additional.reservation. fraction.max'] = "tez.task.scale.memory.additional-reservation.fraction.max"
tez_depr_prop_hash['tez.task.initial.memory.scale.ratios'] = "tez.task.scale.memory.ratios"
tez_depr_prop_hash['tez.resource.calculator.process-tree.class'] = "tez.task.resource.calculator.process-tree.class"

import re
for line in fileinput.input():
    # find deprecated hadoop props
    match=False;
    for old in sorted(hdp_depr_prop_hash.keys(), key=len, reverse=True):
        if re.search(r'%s' % old, line) is not None:
            sys.stdout.write("%s" % line.replace(old, hdp_depr_prop_hash[old]) )
            match=True;
    # find deprecated tez props
    for old in sorted(tez_depr_prop_hash.keys(), key=len, reverse=True):
        if re.search(r'%s' % old, line) is not None:
            sys.stdout.write("%s" % line.replace(old, tez_depr_prop_hash[old]) )
            match=True;

    if (match==False):
        sys.stdout.write("%s" % line)
